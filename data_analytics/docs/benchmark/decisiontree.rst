.. 
   Copyright 2019 Xilinx, Inc.
  
   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at
  
       http://www.apache.org/licenses/LICENSE-2.0
  
   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.

.. _dt_rf_benchmark:

*****************
Benchmark Result
*****************

Performance Data
================

The performance of FPGA accelerated query execution is compared against Spark running time in local mode.
The result is summarized in the table below.

For both FPGA and C++, time is measured assuming the data is already loaded into CPU main memory.
And Spark times don' include the time of loading data from svm files and getting splits.

In the table below, Spark numbre is collected with version 2.4.4 on
Intel(R) Xeon(R) CPU E5-2690 v4, clocked at 2.60GHz, 256G RAM memory.

Dataset:

 1 - HEPMASS (http://archive.ics.uci.edu/ml/machine-learning-databases/00347/1000_train.csv.gz) 

 2 - HIGGS   (http://archive.ics.uci.edu/ml/machine-learning-databases/00280/)

Decision Tree
~~~~~~~~~~~~~~

+---------+--------------+------------+------------+----------+------------+-----------+
| Dataset | Kernel Used  | Tree Depth | End-to-End | Speedup  | Thread num | Spark     |
+---------+--------------+------------+------------+----------+------------+-----------+
|         |              |            | (ms)       | vs Spark |            | (ms)      |
+=========+==============+============+============+==========+============+===========+
| 1       | decisiontree | 9          | 2561.3     | 108      | 1          | 276018    |
+---------+--------------+------------+------------+----------+------------+-----------+
| 1       | decisiontree | 9          | 2561.3     | 58       | 2          | 148364    |
+---------+--------------+------------+------------+----------+------------+-----------+
| 1       | decisiontree | 9          | 2561.3     | 31       | 4          | 78810     |
+---------+--------------+------------+------------+----------+------------+-----------+
| 1       | decisiontree | 9          | 2561.3     | 20       | 8          | 52103     |
+---------+--------------+------------+------------+----------+------------+-----------+
| 1       | decisiontree | 9          | 2561.3     | 14       | 16         | 36289     |
+---------+--------------+------------+------------+----------+------------+-----------+
| 1       | decisiontree | 9          | 2561.3     | 11       | 32         | 27319     |
+---------+--------------+------------+------------+----------+------------+-----------+
| 1       | decisiontree | 9          | 2561.3     | 9        | 56         | 22862     |
+---------+--------------+------------+------------+----------+------------+-----------+
| 1       | decisiontree | 10         | 3880.9     | 70       | 1          | 272264    |
+---------+--------------+------------+------------+----------+------------+-----------+
| 1       | decisiontree | 10         | 3880.9     | 39       | 2          | 150796    |
+---------+--------------+------------+------------+----------+------------+-----------+
| 1       | decisiontree | 10         | 3880.9     | 21       | 4          | 81579     |
+---------+--------------+------------+------------+----------+------------+-----------+
| 1       | decisiontree | 10         | 3880.9     | 13       | 8          | 52322     |
+---------+--------------+------------+------------+----------+------------+-----------+
| 1       | decisiontree | 10         | 3880.9     | 9        | 16         | 36198     |
+---------+--------------+------------+------------+----------+------------+-----------+
| 1       | decisiontree | 10         | 3880.9     | 7        | 32         | 26122     |
+---------+--------------+------------+------------+----------+------------+-----------+
| 1       | decisiontree | 10         | 3880.9     | 6        | 56         | 21606     |
+---------+--------------+------------+------------+----------+------------+-----------+
| 2       | decisiontree | 9          | 2908.3     | 108      | 1          | 343330    |
+---------+--------------+------------+------------+----------+------------+-----------+
| 2       | decisiontree | 9          | 2908.3     | 58       | 2          | 179184    |
+---------+--------------+------------+------------+----------+------------+-----------+
| 2       | decisiontree | 9          | 2908.3     | 31       | 4          | 98505     |
+---------+--------------+------------+------------+----------+------------+-----------+
| 2       | decisiontree | 9          | 2908.3     | 20       | 8          | 59508     |
+---------+--------------+------------+------------+----------+------------+-----------+
| 2       | decisiontree | 9          | 2908.3     | 14       | 16         | 42245     |
+---------+--------------+------------+------------+----------+------------+-----------+
| 2       | decisiontree | 9          | 2908.3     | 11       | 32         | 30622     |
+---------+--------------+------------+------------+----------+------------+-----------+
| 2       | decisiontree | 9          | 2908.3     | 9        | 56         | 25196     |
+---------+--------------+------------+------------+----------+---------- -+-----------+



Random Forest
~~~~~~~~~~~~~~~

+---------+--------------+------------+------------+------------+----------+------------+-----------+
| Dataset | Kernel Used  | Tree Depth | Tree Num   | End-to-End | Speedup  | Thread num | Spark     |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
|         |              |            |            | (s)       | vs Spark |            | (s)      |
+=========+==============+============+============+============+==========+============+===========+
| 1       | randomforest | 5          | 512        | 61.20      | 45.2     | 2          | 2765.143  |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 1       | randomforest | 5          | 512        | 61.20      | 23.8     | 4          | 1457.976  |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 1       | randomforest | 5          | 512        | 61.20      | 13.3     | 8          | 813.216   |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 1       | randomforest | 5          | 512        | 61.20      | 8.8      | 16         | 536.295   |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 1       | randomforest | 5          | 512        | 61.20      | 10.2     | 28         | 622.30    |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 1       | randomforest | 5          | 1024       | 121.20     | 45.9     | 2          | 5565.713  |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 1       | randomforest | 5          | 1024       | 121.20     | 25.0     | 4          | 3032.119  |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 1       | randomforest | 5          | 1024       | 121.20     | 16.2     | 8          | 1968.136  |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 1       | randomforest | 5          | 1024       | 121.20     | 15.3     | 16         | 1849.724  |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 2       | randomforest | 5          | 512        | 70.30      | 45.3     | 2          | 3182.11   |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 2       | randomforest | 5          | 512        | 70.30      | 23.5     | 4          | 1653.86   |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 2       | randomforest | 5          | 512        | 70.30      | 13.0     | 8          | 912.35    |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 2       | randomforest | 5          | 512        | 70.30      | 8.5      | 16         | 599.44    |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 2       | randomforest | 5          | 512        | 70.30      | 13.3     | 28         | 933.83    |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 2       | randomforest | 5          | 1024       | 138.84     | 45.5     | 2          | 6316.731  |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 2       | randomforest | 5          | 1024       | 138.84     | 25.6     | 4          | 3558.351  |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 2       | randomforest | 5          | 1024       | 138.84     | 15.2     | 8          | 2111.73   |
+---------+--------------+------------+------------+------------+----------+------------+-----------+
| 2       | randomforest | 5          | 1024       | 138.84     | 15.5     | 16         | 2154      |
+---------+--------------+------------+------------+------------+----------+------------+-----------+



